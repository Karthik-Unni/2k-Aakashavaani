{% extends 'base.html' %}
{% load socialaccount %}

{% block title %}Home{% endblock title %}

{% block body %}

<div class="ak-main-header">
  <h1>Your Library</h1>
  <small>
    {% if query_search %}
      Showing search results
    {% else %}
      All your favourite tracks in one place
    {% endif %}
  </small>
</div>

<div id="search" class="ak-search-bar">
  <form id="searchform" class="form-horizontal" role="search" method="get" action="">
    <div class="form-group">
      <div class="input-group">
        <input type="text"
               class="form-control input-lg"
               name="q"
               value="{{ request.GET.q }}"
               placeholder="Search songs, artists, albums" />
        <div class="input-group-append">
          <button type="submit" class="btn btn-primary">
            <i class="fa fa-search" aria-hidden="true"></i> Search
          </button>
        </div>
      </div>
    </div>
  </form>
</div>

<section class="ak-hero-card">
  <div class="ak-hero-text">
    <h2>Your Music</h2>
    <h3>On Repeat</h3>
    <p>Jump back into the tracks and playlists you listen to the most.</p>
  </div>
</section>

<h2 class="ak-section-title">
  {% if query_search %}
    Search results
  {% else %}
    All songs
  {% endif %}
</h2>

<section class="ak-grid">
  {% if all_songs %}
    {% for song in all_songs %}
      <article class="ak-card" style="--bg-img: url('{{ song.song_img.url }}');">
        <div class="ak-card-actions">
          <a class="ak-card-btn" href="{% url 'play_song_index' song.id %}">
            <i class="fa fa-play" aria-hidden="true"></i>
          </a>
          <a class="ak-card-btn" href="{% url 'detail' song.id %}">
            <i class="fa fa-info-circle" aria-hidden="true"></i>
          </a>
        </div>
        <div class="ak-card-text">
          <div class="ak-card-title">{{ song.name }}</div>
          <div class="ak-card-subtitle">{{ song.album }}</div>
        </div>
      </article>
    {% endfor %}
  {% else %}
    <p>No songs found.</p>
  {% endif %}
</section>

{% if last_played %}
<footer class="footer">
  <div class="player">
    <div class="left">
      <img src="{{ last_played.song_img.url }}" height="70" width="70">
    </div>
    <div class="right">
      <div class="top">
        <span class="song">{{ last_played.name }}</span>
        <span class="artist">{{ last_played.album }}</span>
      </div>
      <div class="bottom">
        {% if first_time %}
          <audio controls name="media">
            <source src="{{ last_played.song_file.url }}" type="audio/mpeg">
          </audio>
        {% else %}
          <audio controls autoplay name="media">
            <source src="{{ last_played.song_file.url }}" type="audio/mpeg">
          </audio>
        {% endif %}
      </div>
    </div>
  </div>
</footer>
{% endif %}

{% endblock body %}
