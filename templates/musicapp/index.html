{% extends 'base.html' %}
{% load socialaccount %}
{% block title %} Home {% endblock title %}

{% block body %}

<style>
/* PAGE BACKGROUND */
body {
    background: #111 !important;
}

/* SECTION TITLE */
.section-title {
    color: white;
    font-size: 22px;
    font-weight: 700;
    margin-top: 35px;
    margin-bottom: 10px;
}

/* BEAUTIFUL CLEAN GRID */
.song-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 18px;
    padding: 5px;
}

/* CARD */
.song-card {
    background: #181818;
    border-radius: 12px;
    padding: 12px;
    transition: 0.2s ease;
    position: relative;
}

.song-card:hover {
    background: #232323;
}

/* IMAGE */
.song-img {
    width: 100%;
    height: 150px;
    object-fit: cover;
    border-radius: 10px;
}

/* PLAY BUTTON */
.play-button {
    position: absolute;
    bottom: 20px;
    right: 20px;
    background: #1DB954;
    color: white;
    border-radius: 50%;
    width: 42px;
    height: 42px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 18px;
    opacity: 0;
    transition: 0.15s ease;
}

.song-card:hover .play-button {
    opacity: 1;
    transform: translateY(-5px);
}

/* NAME */
.song-name {
    margin-top: 10px;
    color: #fff;
    font-size: 14px;
    font-weight: 600;
}

/* VIEW ALL BOX */
.view-all {
    display: flex;
    justify-content: center;
    align-items: center;
    background: #1DB954;
    border-radius: 12px;
    color: white !important;
    font-weight: bold;
    height: 150px;
}
</style>

<div class="container">

    <!-- SEARCH BAR -->
    <form method="get">
        <div class="input-group mb-4">
            <input type="text" name="q" value="{{ request.GET.q }}"
                   class="form-control"
                   placeholder="Search Songs">
            <span class="input-group-btn mx-2">
                <button class="btn btn-primary">Search</button>
            </span>
        </div>
    </form>

    {% if recent_songs and not query_search %}
    <h3 class="section-title">Recently Played</h3>
    <div class="song-grid">
        {% for song in recent_songs %}
        <div class="song-card">
            <img src="{{ song.song_img.url }}" class="song-img">
            <a class="play-button" href="{% url 'play_song_index' song.id %}">
                <i class="fa fa-play"></i>
            </a>
            <p class="song-name">{{ song.name }}</p>
        </div>
        {% endfor %}

        <a href="{% url 'recent' %}" class="view-all">View All →</a>
    </div>
    {% endif %}

    {% if all_songs and not query_search %}
    <h3 class="section-title">All Songs</h3>
    <div class="song-grid">
        {% for song in all_songs %}
        <div class="song-card">
            <img src="{{ song.song_img.url }}" class="song-img">
            <a class="play-button" href="{% url 'play_song_index' song.id %}">
                <i class="fa fa-play"></i>
            </a>
            <p class="song-name">{{ song.name }}</p>
        </div>
        {% endfor %}
        <a href="{% url 'all_songs' %}" class="view-all">View All →</a>
    </div>
    {% endif %}

    {% if hindi_songs and not query_search %}
    <h3 class="section-title">Hindi Songs</h3>
    <div class="song-grid">
        {% for song in hindi_songs %}
        <div class="song-card">
            <img src="{{ song.song_img.url }}" class="song-img">
            <a class="play-button" href="{% url 'play_song_index' song.id %}">
                <i class="fa fa-play"></i>
            </a>
            <p class="song-name">{{ song.name }}</p>
        </div>
        {% endfor %}
        <a href="{% url 'hindi_songs' %}" class="view-all">View All →</a>
    </div>
    {% endif %}

    {% if english_songs and not query_search %}
    <h3 class="section-title">English Songs</h3>
    <div class="song-grid">
        {% for song in english_songs %}
        <div class="song-card">
            <img src="{{ song.song_img.url }}" class="song-img">
            <a class="play-button" href="{% url 'play_song_index' song.id %}">
                <i class="fa fa-play"></i>
            </a>
            <p class="song-name">{{ song.name }}</p>
        </div>
        {% endfor %}
        <a href="{% url 'english_songs' %}" class="view-all">View All →</a>
    </div>
    {% endif %}

</div>

<br><br><br><br><br>

<!-- DO NOT TOUCH: BOTTOM AUDIO BAR -->
<footer class="footer">
    <div class="player" style="padding-left: 10px;padding-top:10px;background-color: #459dfb;">
      <div class="left"><img src="{{last_played.song_img.url}}" height="90" width="90" style="border-radius: 10px;"></div>
      <div class="right">
         <div class="top">
            <a class="song" style="margin-left: 15px;color: white;">{{last_played.name}}</a>
            <a class="artist" style="margin-left: 15px;color:white">{{last_played.album}}</a>
         </div>
         <div class="bottom">
          {% if first_time %}
            <audio controls name="media" style="margin-left: 20px;margin-bottom: 10px;width: 1230px;height:30px">
                <source src="{{last_played.song_file.url}}" type="audio/mpeg">
            </audio>
          {% else %}
            <audio controls autoplay name="media" style="margin-left: 20px;margin-bottom: 10px;width: 1230px;height:30px">
                <source src="{{last_played.song_file.url}}" type="audio/mpeg">
            </audio>
          {% endif %}
         </div>
      </div>
    </div>
</footer>

{% endblock body %}
